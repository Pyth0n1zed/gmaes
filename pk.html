<script>
  document.getElementById('validationForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent default form submission

    const code = document.getElementById('productCode').value;
    
    // Using All Origins proxy service
    const proxyUrl = 'https://api.allorigins.win/get?url=';
    const targetUrl = encodeURIComponent('https://uhidk.fwh.is/validate.php'); // Replace with your actual backend URL
    const fullUrl = proxyUrl + targetUrl;

    fetch(fullUrl, {
      method: 'GET', // All Origins only supports GET requests
    })
    .then(response => response.json())
    .then(data => {
      if (data.contents) {
        try {
          const parsedData = JSON.parse(data.contents);
          if (parsedData.error) {
            document.getElementById('result').textContent = 'Error: ' + parsedData.error;
          } else {
            document.getElementById('result').textContent = parsedData.message;
          }
        } catch (error) {
          document.getElementById('result').textContent = 'Invalid response from server.';
        }
      } else {
        document.getElementById('result').textContent = 'Error retrieving data.';
      }
    })
    .catch(error => {
      console.error('Fetch error:', error);
      document.getElementById('result').textContent = 'Error validating code: ' + error;
    });
  });
</script>
